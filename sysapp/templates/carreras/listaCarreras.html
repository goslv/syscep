{% extends 'base.html' %}
{% load static %}

{% block title %}Carreras — ITS CEP{% endblock %}
{% block page_title %}Carreras{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/carreras.css' %}">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');

    :root {
        --lk-surface:  #ffffff;
        --lk-ink:      #0f1825;
        --lk-muted:    #64748b;
        --lk-bg:       #f8fafc;
        --lk-blue:     #0756a3;
        --lk-blue-dk:  #071e60;
        --lk-blue-lt:  #e9f0fe;
    }
    [data-theme="dark"] {
        --lk-surface:  #13171d;
        --lk-ink:      #e8ecf0;
        --lk-muted:    #6e7d8f;
        --lk-bg:       #0d1117;
        --lk-blue-lt:  #0d1e35;
    }

    .lk { font-family: 'Plus Jakarta Sans', 'Outfit', sans-serif; color: var(--lk-ink); }
    .lk * { box-sizing: border-box; }

    /* ─── Header — mismo patrón que listaAlumnos ──────────── */
    .lk-head {
        display: flex; align-items: center; justify-content: space-between;
        margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;
    }
    .lk-head-left { display: flex; flex-direction: column; gap: .25rem; }

    .lk-head-title {
        font-family: 'Sora', 'Plus Jakarta Sans', sans-serif;
        font-size: 1.9rem; font-weight: 800; color: var(--lk-ink);
        margin: 0; letter-spacing: -.6px;
        display: flex; align-items: center; gap: .7rem; line-height: 1.1;
    }
    .lk-head-title-icon {
        width: 48px; height: 48px; border-radius: 14px;
        background: var(--lk-blue-lt);
        display: flex; align-items: center; justify-content: center;
        font-size: 1.35rem; color: var(--lk-blue); flex-shrink: 0;
    }
    .lk-breadcrumb {
        font-size: .83rem; color: var(--lk-muted);
        display: flex; align-items: center; gap: .4rem; margin-top: .15rem;
    }
    .lk-breadcrumb a { color: var(--lk-blue); text-decoration: none; font-weight: 600; }
    .lk-breadcrumb a:hover { text-decoration: underline; }
    .lk-breadcrumb i { font-size: .55rem; opacity: .7; }

    /* ─── Cards de Carrera (CSS original preservado) ──────── */
    .carrera-card {
        cursor: pointer;
        background: var(--card-bg, var(--lk-surface));
        border-radius: 16px; padding: 1.5rem;
        box-shadow: 0 2px 8px rgba(0,0,0,.08);
        transition: all 0.3s ease;
        position: relative; overflow: hidden;
        height: 100%; display: flex; flex-direction: column;
    }
    .carrera-card:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,.15); }
    .carrera-card::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
    }
    .carrera-card.tecnico-superior::before { background: linear-gradient(90deg, var(--primary-600), var(--primary-400)); }
    .carrera-card.formacion-profesional::before { background: linear-gradient(90deg, var(--info-dark), var(--info)); }

    .carrera-icon {
        width: 48px; height: 48px; border-radius: 12px;
        display: flex; align-items: center; justify-content: center;
        font-size: 24px; margin-bottom: 1rem;
    }
    .carrera-icon.ts { background: var(--primary-50); color: var(--primary-600); }
    .carrera-icon.fp { background: var(--info-light); color: var(--info-dark); }

    .carrera-header { margin-bottom: 1rem; }
    .carrera-title { font-size: 1.25rem; font-weight: 600; color: var(--text-main, var(--lk-ink)); margin-bottom: .5rem; line-height: 1.3; }
    .carrera-type {
        display: inline-block; padding: .25rem .75rem; border-radius: 20px;
        font-size: .75rem; font-weight: 600; text-transform: uppercase; letter-spacing: .5px;
    }
    .carrera-type.ts { background: var(--primary-50); color: var(--primary-600); }
    .carrera-type.fp { background: var(--info-light); color: var(--info-dark); }

    .carrera-stats {
        display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;
        padding: 1rem; background: var(--gray-100); border-radius: 12px; margin-bottom: 1rem;
    }
    .stat-item { text-align: center; }
    .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--text-main, var(--lk-ink)); margin-bottom: .25rem; }
    .stat-label { font-size: .75rem; color: var(--gray-500); text-transform: uppercase; letter-spacing: .5px; }

    .materias-preview { margin-top: auto; padding-top: 1rem; }
    .materias-preview h6 { font-size: .875rem; font-weight: 600; color: var(--gray-600); margin-bottom: .75rem; text-transform: uppercase; letter-spacing: .5px; }
    .materia-chip {
        display: inline-flex; align-items: center; gap: .25rem;
        padding: .375rem .75rem; background: var(--gray-100); color: var(--gray-600);
        border-radius: 20px; font-size: .813rem; margin-right: .5rem; margin-bottom: .5rem; transition: all .2s;
    }
    .materia-chip:hover { background: var(--gray-200); color: var(--gray-800); }
    .materia-chip i { font-size: .75rem; }

    .carrera-actions { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--gray-200); }
    .btn-view-detail {
        display: flex; align-items: center; justify-content: center; gap: .5rem;
        width: 100%; padding: .75rem 1rem;
        background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-500) 100%);
        color: white; text-decoration: none; border-radius: 8px;
        font-weight: 600; font-size: .875rem; transition: all .3s; font-family: 'Outfit', sans-serif;
    }
    .btn-view-detail:hover { background: linear-gradient(135deg, var(--primary-700) 0%, var(--primary-600) 100%); color: white; transform: scale(1.02); }
    .btn-view-detail i { font-size: 1rem; }

    .empty-state {
        text-align: center; padding: 4rem 2rem;
        background: var(--card-bg, var(--lk-surface));
        border-radius: 16px; box-shadow: 0 2px 8px rgba(0,0,0,.08);
    }
    .empty-state i { font-size: 4rem; color: #cbd5e1; margin-bottom: 1.5rem; }
    .empty-state h5 { font-size: 1.5rem; font-weight: 600; color: var(--lk-ink); margin-bottom: .75rem; }
    .empty-state p { color: var(--lk-muted); margin-bottom: 2rem; font-size: 1rem; }

    /* Dark mode overrides */
    [data-theme="dark"] .carrera-stats,
    [data-theme="dark"] .materia-chip { background: #0f172a !important; color: var(--lk-muted) !important; }
    [data-theme="dark"] .carrera-title { color: var(--lk-ink) !important; }
    [data-theme="dark"] .carrera-icon.ts { background: rgba(0,191,255,.1); color: var(--primary-400); }
    [data-theme="dark"] .carrera-icon.fp { background: rgba(59,130,246,.1); color: var(--info); }
    [data-theme="dark"] .carrera-type.ts { background: rgba(0,191,255,.1); color: var(--primary-400); }
    [data-theme="dark"] .carrera-type.fp { background: rgba(59,130,246,.1); color: var(--info); }
    [data-theme="dark"] .stat-value { color: var(--lk-ink) !important; }
    [data-theme="dark"] .carrera-actions { border-top-color: var(--border, #2a2f38); }
    [data-theme="dark"] .empty-state { background: var(--lk-surface) !important; }
    [data-theme="dark"] .empty-state h5 { color: var(--lk-ink) !important; }
    [data-theme="dark"] .empty-state p  { color: var(--lk-muted) !important; }

    @media(max-width:768px) {
        .lk-head { flex-direction: column; align-items: stretch; }
        .carrera-stats { gap: .75rem; padding: .75rem; }
        .stat-value { font-size: 1.25rem; }
        .carrera-title { font-size: 1.125rem; }
    }
    @media(max-width:576px) {
        .carrera-card { padding: 1.25rem; }
    }
</style>
{% endblock %}

{% block content %}
<div class="lk mt-5">

    <!-- ── Header — mismo patrón que listaAlumnos ─────────── -->
    <div class="lk-head">
        <div class="lk-head-left">
            <div class="lk-head-title">
                <div class="lk-head-title-icon">
                    <i class="bi bi-mortarboard-fill"></i>
                </div>
                Carreras
            </div>
            <div class="lk-breadcrumb">
                <a href="{% url 'dashboard' %}">Inicio</a>
                <i class="bi bi-chevron-right"></i>
                <span>Gestión de Carreras</span>
            </div>
        </div>
        <div>
            <a href="{% url 'crear_carrera' %}"
               class="btn btn-success d-inline-flex align-items-center gap-2"
               style="border-radius:12px; font-weight:700; padding:.65rem 1.3rem; font-family:'Outfit',sans-serif;">
                <i class="bi bi-plus-circle"></i> Nueva Carrera/Curso
            </a>
        </div>
    </div>

    <!-- ── Grid de carreras (HTML original preservado) ──────── -->
    {% if carreras %}
    <div class="row g-4">
        {% for carrera in carreras %}
        <div class="col-md-6 col-lg-4">
            <a href="{% url 'detalle_carrera' carrera.id %}" class="text-decoration-none h-100 d-block">
                <div class="carrera-card {% if carrera.naturalidad == 'TS' %}tecnico-superior{% else %}formacion-profesional{% endif %}">
                    <div class="carrera-icon {% if carrera.naturalidad == 'TS' %}ts{% else %}fp{% endif %}">
                        <i class="bi bi-mortarboard-fill"></i>
                    </div>
                    <div class="carrera-header">
                        <h4 class="carrera-title">{{ carrera.nombre }}</h4>
                        <span class="carrera-type {% if carrera.naturalidad == 'TS' %}ts{% else %}fp{% endif %}">
                            <i class="bi {% if carrera.naturalidad == 'TS' %}bi-award{% else %}bi-tools{% endif %}"></i>
                            {{ carrera.get_naturalidad_display }}
                        </span>
                    </div>

                    {% if carrera.materias.all %}
                    <div class="materias-preview">
                        <h6>Materias</h6>
                        {% for materia in carrera.materias.all|slice:":4" %}
                        <span class="materia-chip">
                            <i class="bi bi-book"></i>{{ materia.nombre }}
                        </span>
                        {% endfor %}
                        {% if carrera.materias.count > 4 %}
                        <span class="materia-chip">+{{ carrera.materias.count|add:"-4" }} más</span>
                        {% endif %}
                    </div>
                    {% endif %}

                    <div class="carrera-actions">
                        <div class="btn-view-detail">
                            <i class="bi bi-eye-fill"></i> Ver detalle
                        </div>
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <i class="bi bi-mortarboard"></i>
        <h5>No hay carreras registradas</h5>
        <p>Por el momento no hay carreras disponibles en el sistema.</p>
        <a href="{% url 'crear_carrera' %}" class="btn btn-success d-inline-flex align-items-center gap-2"
           style="border-radius:12px; font-weight:700;">
            <i class="bi bi-plus-circle"></i> Crear primera carrera
        </a>
    </div>
    {% endif %}

</div>
{% endblock %}